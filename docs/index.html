<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HTTP Client • crul</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="HTTP Client">
<meta property="og:description" content="A simple HTTP client, with tools for making HTTP requests,
    and mocking HTTP requests. The package is built on R6, and takes
    inspiration from Ruby's 'faraday' gem (&lt;https://rubygems.org/gems/faraday&gt;).
    The package name is a play on curl, the widely used command line tool
    for HTTP, and this package is built on top of the R package 'curl', an
    interface to 'libcurl' (&lt;https://curl.haxx.se/libcurl&gt;).">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">crul</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.1.9120</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/crul.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/async.html">async with crul</a>
    </li>
    <li>
      <a href="articles/best-practices-api-packages.html">API package best practices</a>
    </li>
    <li>
      <a href="articles/curl-options.html">curl options</a>
    </li>
    <li>
      <a href="articles/how-to-use-crul.html">crul workflows</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/crul">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<div id="crul" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#crul" class="anchor"></a>crul</h1></div>

<p>An HTTP client, taking inspiration from Ruby’s <a href="https://rubygems.org/gems/faraday">faraday</a> and Python’s <a href="http://docs.python-requests.org/en/master/">requests</a></p>
<p>Package API:</p>
<ul>
<li>
<code>HttpClient</code> - Main interface to making HTTP requests. Synchronous requests only.</li>
<li>
<code>HttpResponse</code> - HTTP response object, used for all responses across the different clients.</li>
<li>
<code>Paginator</code> - Auto-paginate through requests - supports a subset of all possible pagination scenarios - will fill out more scenarios soon</li>
<li>
<code>Async</code> - Asynchronous HTTP requests - a simple interface for many URLS - whose interface is similar to <code>HttpClient</code> - all URLs are treated the same.</li>
<li>
<code>AsyncVaried</code> - Asynchronous HTTP requests - accepts any number of <code>HttpRequest</code> objects - with a different interface than <code>HttpClient</code>/<code>Async</code> due to the nature of handling requests with different HTTP methods, options, etc.</li>
<li>
<code>HttpRequest</code> - HTTP request object, used for <code>AsyncVaried</code>
</li>
<li>
<code><a href="reference/mock.html">mock()</a></code> - Turn on/off mocking, via <code>webmockr</code>
</li>
<li>
<code><a href="reference/auth.html">auth()</a></code> - Simple authentication helper</li>
<li>
<code><a href="reference/proxies.html">proxy()</a></code> - Proxy helper</li>
<li>
<code><a href="reference/upload.html">upload()</a></code> - File upload helper</li>
<li>set curl options globally: <code><a href="reference/crul-options.html">set_auth()</a></code>, <code><a href="reference/crul-options.html">set_headers()</a></code>, <code><a href="reference/crul-options.html">set_opts()</a></code>, <code><a href="reference/crul-options.html">set_proxy()</a></code>, and <code><a href="reference/crul-options.html">crul_settings()</a></code>
</li>
<li>Writing to disk and streaming: available with both synchronous requests as well as async requests</li>
<li>Hooks on requests and responses are available in the <code>HttpClient</code> method only, and allow you to trigger functions to run on requests or responses, or both. See <code><a href="reference/hooks.html">?hooks</a></code> for the details and examples</li>
</ul>
<p>Mocking:</p>
<p><code>crul</code> now integrates with <a href="https://github.com/ropensci/webmockr">webmockr</a> to mock HTTP requests. Checkout the <a href="https://ropenscilabs.github.io/http-testing-book/">http testing book</a></p>
<p>Caching:</p>
<p><code>crul</code> also integrates with <a href="https://github.com/ropensci/vcr">vcr</a> to cache http requests/responses. Checkout the <a href="https://ropenscilabs.github.io/http-testing-book/">http testing book</a></p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>CRAN version</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"crul"</span>)</span></code></pre></div>
<p>Dev version</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/reexports.html">install_github</a></span>(<span class="st">"ropensci/crul"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"crul"</span>)</span></code></pre></div>
</div>
<div id="the-client" class="section level2">
<h2 class="hasAnchor">
<a href="#the-client" class="anchor"></a>the client</h2>
<p><code>HttpClient</code> is where to start</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>(x &lt;-<span class="st"> </span>HttpClient<span class="op">$</span><span class="kw">new</span>(</span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="dt">url =</span> <span class="st">"https://httpbin.org"</span>,</span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="dt">opts =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="dt">timeout =</span> <span class="dv">1</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  ),</span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="dt">headers =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="dt">a =</span> <span class="st">"hello world"</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>  )</span>
<span id="cb4-9"><a href="#cb4-9"></a>))</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt; &lt;crul connection&gt; </span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt;   url: https://httpbin.org</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt;   curl options: </span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt;     timeout: 1</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt;   proxies: </span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt;   auth: </span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">#&gt;   headers: </span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">#&gt;     a: hello world</span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">#&gt;   progress: FALSE</span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co">#&gt;   hooks:</span></span></code></pre></div>
<p>Makes an R6 class, that has all the bits and bobs you’d expect for doing HTTP requests. When it prints, it gives any defaults you’ve set. As you update the object you can see what’s been set</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>x<span class="op">$</span>opts</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt; $timeout</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>x<span class="op">$</span>headers</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt; $a</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; [1] "hello world"</span></span></code></pre></div>
<p>You can also pass in curl options when you make HTTP requests, see below for examples.</p>
</div>
<div id="do-some-http" class="section level2">
<h2 class="hasAnchor">
<a href="#do-some-http" class="anchor"></a>do some http</h2>
<p>The client object created above has http methods that you can call, and pass paths to, as well as query parameters, body values, and any other curl options.</p>
<p>Here, we’ll do a <strong>GET</strong> request on the route <code>/get</code> on our base url <code>https://httpbin.org</code> (the full url is then <code>https://httpbin.org/get</code>)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>res &lt;-<span class="st"> </span>x<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>(<span class="st">"get"</span>)</span></code></pre></div>
<p>The response from a http request is another R6 class <code>HttpResponse</code>, which has slots for the outputs of the request, and some functions to deal with the response:</p>
<p>Status code</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>res<span class="op">$</span>status_code</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt; [1] 200</span></span></code></pre></div>
<p>Status information</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>res<span class="op">$</span><span class="kw">status_http</span>()</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt; &lt;Status code: 200&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt;   Message: OK</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt;   Explanation: Request fulfilled, document follows</span></span></code></pre></div>
<p>The content</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>res<span class="op">$</span>content</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#&gt;   [1] 7b 0a 20 20 22 61 72 67 73 22 3a 20 7b 7d 2c 20 0a 20 20 22 68 65 61</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">#&gt;  [24] 64 65 72 73 22 3a 20 7b 0a 20 20 20 20 22 41 22 3a 20 22 68 65 6c 6c</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt;  [47] 6f 20 77 6f 72 6c 64 22 2c 20 0a 20 20 20 20 22 41 63 63 65 70 74 22</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt;  [70] 3a 20 22 61 70 70 6c 69 63 61 74 69 6f 6e 2f 6a 73 6f 6e 2c 20 74 65</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt;  [93] 78 74 2f 78 6d 6c 2c 20 61 70 70 6c 69 63 61 74 69 6f 6e 2f 78 6d 6c</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; [116] 2c 20 2a 2f 2a 22 2c 20 0a 20 20 20 20 22 41 63 63 65 70 74 2d 45 6e</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; [139] 63 6f 64 69 6e 67 22 3a 20 22 67 7a 69 70 2c 20 64 65 66 6c 61 74 65</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt; [162] 22 2c 20 0a 20 20 20 20 22 48 6f 73 74 22 3a 20 22 68 74 74 70 62 69</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; [185] 6e 2e 6f 72 67 22 2c 20 0a 20 20 20 20 22 55 73 65 72 2d 41 67 65 6e</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt; [208] 74 22 3a 20 22 6c 69 62 63 75 72 6c 2f 37 2e 35 34 2e 30 20 72 2d 63</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt; [231] 75 72 6c 2f 34 2e 30 20 63 72 75 6c 2f 30 2e 38 2e 31 2e 39 31 32 30</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt; [254] 22 0a 20 20 7d 2c 20 0a 20 20 22 6f 72 69 67 69 6e 22 3a 20 22 32 34</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt; [277] 2e 32 33 37 2e 31 35 32 2e 36 34 2c 20 32 34 2e 32 33 37 2e 31 35 32</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#&gt; [300] 2e 36 34 22 2c 20 0a 20 20 22 75 72 6c 22 3a 20 22 68 74 74 70 73 3a</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">#&gt; [323] 2f 2f 68 74 74 70 62 69 6e 2e 6f 72 67 2f 67 65 74 22 0a 7d 0a</span></span></code></pre></div>
<p>HTTP method</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>res<span class="op">$</span>method</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#&gt; [1] "get"</span></span></code></pre></div>
<p>Request headers</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>res<span class="op">$</span>request_headers</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#&gt; $`User-Agent`</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt; [1] "libcurl/7.54.0 r-curl/4.0 crul/0.8.1.9120"</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt; </span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt; $`Accept-Encoding`</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#&gt; [1] "gzip, deflate"</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt; </span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt; $Accept</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt; [1] "application/json, text/xml, application/xml, */*"</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt; </span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">#&gt; $a</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt; [1] "hello world"</span></span></code></pre></div>
<p>Response headers</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>res<span class="op">$</span>response_headers</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">#&gt; $status</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; [1] "HTTP/1.1 200 OK"</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt; </span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt; $`access-control-allow-credentials`</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt; [1] "true"</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; </span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt; $`access-control-allow-origin`</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt; [1] "*"</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">#&gt; </span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">#&gt; $`content-encoding`</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">#&gt; [1] "gzip"</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co">#&gt; </span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">#&gt; $`content-type`</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">#&gt; [1] "application/json"</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co">#&gt; </span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co">#&gt; $date</span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="co">#&gt; [1] "Wed, 24 Jul 2019 22:28:42 GMT"</span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">#&gt; </span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">#&gt; $`referrer-policy`</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">#&gt; [1] "no-referrer-when-downgrade"</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">#&gt; </span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">#&gt; $server</span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="co">#&gt; [1] "nginx"</span></span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="co">#&gt; </span></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="co">#&gt; $`x-content-type-options`</span></span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="co">#&gt; [1] "nosniff"</span></span>
<span id="cb13-28"><a href="#cb13-28"></a><span class="co">#&gt; </span></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="co">#&gt; $`x-frame-options`</span></span>
<span id="cb13-30"><a href="#cb13-30"></a><span class="co">#&gt; [1] "DENY"</span></span>
<span id="cb13-31"><a href="#cb13-31"></a><span class="co">#&gt; </span></span>
<span id="cb13-32"><a href="#cb13-32"></a><span class="co">#&gt; $`x-xss-protection`</span></span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="co">#&gt; [1] "1; mode=block"</span></span>
<span id="cb13-34"><a href="#cb13-34"></a><span class="co">#&gt; </span></span>
<span id="cb13-35"><a href="#cb13-35"></a><span class="co">#&gt; $`content-length`</span></span>
<span id="cb13-36"><a href="#cb13-36"></a><span class="co">#&gt; [1] "231"</span></span>
<span id="cb13-37"><a href="#cb13-37"></a><span class="co">#&gt; </span></span>
<span id="cb13-38"><a href="#cb13-38"></a><span class="co">#&gt; $connection</span></span>
<span id="cb13-39"><a href="#cb13-39"></a><span class="co">#&gt; [1] "keep-alive"</span></span></code></pre></div>
<p>All response headers - e.g., intermediate headers</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>res<span class="op">$</span>response_headers_all</span></code></pre></div>
<p>And you can parse the content with <code><a href="https://rdrr.io/r/base/parse.html">parse()</a></code></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>res<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/parse.html">parse</a></span>()</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">#&gt; No encoding supplied: defaulting to UTF-8.</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">#&gt; [1] "{\n  \"args\": {}, \n  \"headers\": {\n    \"A\": \"hello world\", \n    \"Accept\": \"application/json, text/xml, application/xml, */*\", \n    \"Accept-Encoding\": \"gzip, deflate\", \n    \"Host\": \"httpbin.org\", \n    \"User-Agent\": \"libcurl/7.54.0 r-curl/4.0 crul/0.8.1.9120\"\n  }, \n  \"origin\": \"24.237.152.64, 24.237.152.64\", \n  \"url\": \"https://httpbin.org/get\"\n}\n"</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>jsonlite<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html">fromJSON</a></span>(res<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/parse.html">parse</a></span>())</span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#&gt; No encoding supplied: defaulting to UTF-8.</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#&gt; $args</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt; named list()</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#&gt; </span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#&gt; $headers</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt; $headers$A</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#&gt; [1] "hello world"</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">#&gt; </span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co">#&gt; $headers$Accept</span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">#&gt; [1] "application/json, text/xml, application/xml, */*"</span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co">#&gt; </span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">#&gt; $headers$`Accept-Encoding`</span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">#&gt; [1] "gzip, deflate"</span></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co">#&gt; </span></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="co">#&gt; $headers$Host</span></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co">#&gt; [1] "httpbin.org"</span></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="co">#&gt; </span></span>
<span id="cb15-22"><a href="#cb15-22"></a><span class="co">#&gt; $headers$`User-Agent`</span></span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="co">#&gt; [1] "libcurl/7.54.0 r-curl/4.0 crul/0.8.1.9120"</span></span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="co">#&gt; </span></span>
<span id="cb15-25"><a href="#cb15-25"></a><span class="co">#&gt; </span></span>
<span id="cb15-26"><a href="#cb15-26"></a><span class="co">#&gt; $origin</span></span>
<span id="cb15-27"><a href="#cb15-27"></a><span class="co">#&gt; [1] "24.237.152.64, 24.237.152.64"</span></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="co">#&gt; </span></span>
<span id="cb15-29"><a href="#cb15-29"></a><span class="co">#&gt; $url</span></span>
<span id="cb15-30"><a href="#cb15-30"></a><span class="co">#&gt; [1] "https://httpbin.org/get"</span></span></code></pre></div>
</div>
<div id="curl-options" class="section level2">
<h2 class="hasAnchor">
<a href="#curl-options" class="anchor"></a>curl options</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>res &lt;-<span class="st"> </span>HttpClient<span class="op">$</span><span class="kw">new</span>(<span class="dt">url =</span> <span class="st">"http://api.gbif.org/v1/occurrence/search"</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>res<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>(<span class="dt">query =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">limit =</span> <span class="dv">100</span>), <span class="dt">timeout_ms =</span> <span class="dv">100</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#&gt; Error in curl::curl_fetch_memory(x$url$url, handle = x$url$handle) :</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#&gt;   Timeout was reached</span></span></code></pre></div>
</div>
<div id="asynchronous-requests" class="section level2">
<h2 class="hasAnchor">
<a href="#asynchronous-requests" class="anchor"></a>Asynchronous requests</h2>
<p>The simpler interface allows many requests (many URLs), but they all get the same options/headers, etc. and you have to use the same HTTP method on all of them:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>(cc &lt;-<span class="st"> </span>Async<span class="op">$</span><span class="kw">new</span>(</span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="dt">urls =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</span>
<span id="cb17-3"><a href="#cb17-3"></a>    <span class="st">'https://httpbin.org/'</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>    <span class="st">'https://httpbin.org/get?a=5'</span>,</span>
<span id="cb17-5"><a href="#cb17-5"></a>    <span class="st">'https://httpbin.org/get?foo=bar'</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>  )</span>
<span id="cb17-7"><a href="#cb17-7"></a>))</span>
<span id="cb17-8"><a href="#cb17-8"></a>res &lt;-<span class="st"> </span>cc<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>()</span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(res, <span class="cf">function</span>(z) z<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/parse.html">parse</a></span>(<span class="st">"UTF-8"</span>))</span></code></pre></div>
<p>The <code>AsyncVaried</code> interface accepts any number of <code>HttpRequest</code> objects, which can define any type of HTTP request of any HTTP method:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>req1 &lt;-<span class="st"> </span>HttpRequest<span class="op">$</span><span class="kw">new</span>(</span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="dt">url =</span> <span class="st">"https://httpbin.org/get"</span>,</span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="dt">opts =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">verbose =</span> <span class="ot">TRUE</span>),</span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="dt">headers =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">foo =</span> <span class="st">"bar"</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a>)<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>()</span>
<span id="cb18-6"><a href="#cb18-6"></a>req2 &lt;-<span class="st"> </span>HttpRequest<span class="op">$</span><span class="kw">new</span>(<span class="dt">url =</span> <span class="st">"https://httpbin.org/post"</span>)<span class="op">$</span><span class="kw">post</span>()</span>
<span id="cb18-7"><a href="#cb18-7"></a>out &lt;-<span class="st"> </span>AsyncVaried<span class="op">$</span><span class="kw">new</span>(req1, req2)</span></code></pre></div>
<p>Execute the requests</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>out<span class="op">$</span><span class="kw">request</span>()</span></code></pre></div>
<p>Then functions get applied to all responses:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>out<span class="op">$</span><span class="kw">status</span>()</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">#&gt; &lt;Status code: 200&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">#&gt;   Message: OK</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">#&gt;   Explanation: Request fulfilled, document follows</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">#&gt; </span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co">#&gt; &lt;Status code: 200&gt;</span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co">#&gt;   Message: OK</span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co">#&gt;   Explanation: Request fulfilled, document follows</span></span>
<span id="cb20-11"><a href="#cb20-11"></a>out<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/parse.html">parse</a></span>()</span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co">#&gt; [1] "{\n  \"args\": {}, \n  \"headers\": {\n    \"Accept\": \"application/json, text/xml, application/xml, */*\", \n    \"Accept-Encoding\": \"gzip, deflate\", \n    \"Foo\": \"bar\", \n    \"Host\": \"httpbin.org\", \n    \"User-Agent\": \"R (3.6.1 x86_64-apple-darwin15.6.0 x86_64 darwin15.6.0)\"\n  }, \n  \"origin\": \"24.237.152.64, 24.237.152.64\", \n  \"url\": \"https://httpbin.org/get\"\n}\n"                                                                                                                                        </span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="co">#&gt; [2] "{\n  \"args\": {}, \n  \"data\": \"\", \n  \"files\": {}, \n  \"form\": {}, \n  \"headers\": {\n    \"Accept\": \"application/json, text/xml, application/xml, */*\", \n    \"Accept-Encoding\": \"gzip, deflate\", \n    \"Content-Length\": \"0\", \n    \"Content-Type\": \"application/x-www-form-urlencoded\", \n    \"Host\": \"httpbin.org\", \n    \"User-Agent\": \"libcurl/7.54.0 r-curl/4.0 crul/0.8.1.9120\"\n  }, \n  \"json\": null, \n  \"origin\": \"24.237.152.64, 24.237.152.64\", \n  \"url\": \"https://httpbin.org/post\"\n}\n"</span></span></code></pre></div>
</div>
<div id="progress-bars" class="section level2">
<h2 class="hasAnchor">
<a href="#progress-bars" class="anchor"></a>Progress bars</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(httr)</span>
<span id="cb21-2"><a href="#cb21-2"></a>x &lt;-<span class="st"> </span>HttpClient<span class="op">$</span><span class="kw">new</span>(</span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="dt">url =</span> <span class="st">"https://httpbin.org/bytes/102400"</span>, </span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="dt">progress =</span> <span class="kw"><a href="reference/progress.html">progress</a></span>()</span>
<span id="cb21-5"><a href="#cb21-5"></a>)</span>
<span id="cb21-6"><a href="#cb21-6"></a>z &lt;-<span class="st"> </span>x<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>()</span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="op">|</span><span class="er">==============================================|</span><span class="st"> </span><span class="dv">100</span>%</span></code></pre></div>
</div>
<div id="to-do" class="section level2">
<h2 class="hasAnchor">
<a href="#to-do" class="anchor"></a>TO DO</h2>
<ul>
<li>…</li>
</ul>
</div>
<div id="meta" class="section level2">
<h2 class="hasAnchor">
<a href="#meta" class="anchor"></a>Meta</h2>
<ul>
<li>Please <a href="https://github.com/ropensci/crul/issues">report any issues or bugs</a>.</li>
<li>License: MIT</li>
<li>Get citation information for <code>crul</code> in R doing <code><a href="https://rdrr.io/r/utils/citation.html">citation(package = 'crul')</a></code>
</li>
<li>Please note that this project is released with a <a href="https://github.com/ropensci/crul/blob/master/CODE_OF_CONDUCT.md">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</li>
</ul>
<p><a href="https://ropensci.org"><img src="https://ropensci.org/public_images/github_footer.png" alt="ropensci_footer"></a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=crul">https://​cloud.r-project.org/​package=crul</a>
</li>
<li>Browse source code at <br><a href="https://github.com/ropensci/crul">https://​github.com/​ropensci/​crul</a>
</li>
<li>Report a bug at <br><a href="https://github.com/ropensci/crul/issues">https://​github.com/​ropensci/​crul/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Scott Chamberlain <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-1444-9135" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID" height="16"></a> </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="http://www.repostatus.org/#active"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://travis-ci.org/ropensci/crul"><img src="https://travis-ci.org/ropensci/crul.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://codecov.io/gh/ropensci/crul"><img src="https://codecov.io/gh/ropensci/crul/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://cranchecks.info/pkgs/crul"><img src="https://cranchecks.info/badges/worst/crul" alt="cran checks"></a></li>
<li><a href="https://github.com/metacran/cranlogs.app"><img src="http://cranlogs.r-pkg.org/badges/crul" alt="rstudio mirror downloads"></a></li>
<li><a href="https://cran.r-project.org/package=crul"><img src="https://www.r-pkg.org/badges/version/crul" alt="cran version"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Scott Chamberlain.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
